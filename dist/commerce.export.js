var Commerce,indexOf=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};Commerce=function(){"use strict";function Commerce(publicKey,debug,config){switch(null==debug&&(debug=!1),null==config&&(config={}),this.options=this.Merge(this.options,{publicKey:publicKey,debug:debug,config:config}),this.Storage=new Commerce.Storage(this),window.location.hostname){case"checkout.chec.local":case"spaces.chec.local":this.options.url="api.chec.local";break;case"stage.checkout.chec.io":this.options.url="stage.api.chec.io";break;case"checkout.chec.io":this.options.url="api.chec.io";break;default:this.options.url="api.chec.io"}this.Cart=new Commerce.Cart(this),this.Checkout=new Commerce.Checkout(this),this.Products=new Commerce.Products(this),this.Services=new Commerce.Services(this),this.Categories=new Commerce.Categories(this),this.Merchants=new Commerce.Merchants(this),debug&&this.Request("tools/console_debugger","GET",null,function(data){return eval(data.eval)})}return Commerce.prototype.options={publicKey:"",auth:{},version:"v1",methods:["GET","POST","PUT","DELETE"],debug:!1,config:{}},Commerce.prototype.Merge=function(a,b){var c,d,e;d={};for(c in a)e=a[c],d[c]=e;for(c in b)e=b[c],d[c]=e;return d},Commerce.prototype.Event=function(a){var b;return b=document.createEvent("CustomEvent"),b.initCustomEvent("Commercejs."+a,!1,!1,this),window.dispatchEvent(b)},Commerce.prototype.InArray=function(a,b){return!(!b||indexOf.call(b,a)<0)},Commerce.prototype.Serialize=function(a,b){var c,d,e;null==b&&(b=null),d=[];for(c in a)e=a[c],c=null!==b?b+"["+c+"]":c,d.push("object"==typeof e?this.Serialize(e,c):encodeURIComponent(c)+"="+encodeURIComponent(e));return d.join("&")},Commerce.prototype.Error=function(a){var b,c;return c="["+a.status_code+"] Type: "+a.error.type,b=""+a.error.message,ChecConsoleHelper("error",c,b,a)},Commerce.prototype.Ajax=function(a){var b,c,d,e,f,g;b={method:"GET",async:!0,data:null,timeout:6e4,headers:{},host:this.options.url,port:"api.chec.io"===this.options.url?443:80,path:"/",success:function(a,b,c){},error:function(a,b,c){}},b=this.Merge(b,a),b.method=b.method.toUpperCase();try{e=new XMLHttpRequest}catch(a){a;try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){return a,!1}}b.url=(443===b.port?"https://":"http://")+b.host+("/"!==b.path.substr(0,1)?"/"+this.options.version+"/"+b.path:b.path),"GET"===b.method?(b.url+="?"+this.Serialize(b.data),b.data=null):b.data=this.Serialize(b.data),e.open(b.method,b.url,b.async),f=setTimeout(function(a){return function(){return e.abort(),b.error(e,408,"Your request timed out")}}(),b.timeout),d=b.headers;for(c in d)g=d[c],e.setRequestHeader(c,g);return e.onreadystatechange=function(){var a;return 4!==e.readyState?null:(clearTimeout(f),a=JSON.parse(e.responseText),"2"!==e.status.toString().charAt(0)?b.error(a,e.status,e):b.success(a,e.status,e))},e.send(b.data)},Commerce.prototype.Request=function(a,b,c,d,e){var f,g;if(null==b&&(b="GET"),null==c&&(c=null),f={},g={"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json","X-Authorization":this.options.publicKey,"X-Chec-Agent":"commerce.js/v1"},null===this.options.publicKey&&alert("Please enter your public api key"),this.InArray(b,this.options.methods)||"function"==typeof e&&e("error","Invalid request method ("+b+")",400),this.Ajax({method:b,path:a,data:c,async:!0,headers:g,success:function(a){return function(b,c,e){return!0===a.options.debug&&"object"==typeof b._console&&ChecConsoleHelper(b._console[0],b._console[1],b._console[2]),"string"==typeof b._event&&a.Event(b._event),"function"==typeof d?d(b,void 0!==b.pagination?b.pagination:null):b}}(this),error:function(a){return function(b,c,g){if("function"==typeof e)e(b);else{if(!0===a.options.debug&&a.Error(b),"function"!=typeof d)return b;d(b,void 0!==b.pagination?b.pagination:null)}return f=b}}(this)}),void 0===d)return f.r},Commerce}(),Commerce.Storage=function(){function a(a){this.c=a}return a.prototype.set=function(a,b,c){var d,e,f;return d=void 0,e=void 0,e="",f=void 0===this.c.options.config.cookie_path?"/":this.c.options.config.cookie_path,c&&(d=new Date,d.setTime(d.getTime()+24*c*60*60*1e3),e="; expires="+d.toGMTString()),document.cookie=a+"="+b+e+"; path="+f},a.prototype.get=function(a){var b,c,d,e;for(a+="=",e=document.cookie.split(";"),c=0,d=e.length;c<d;c++){for(b=e[c];" "===b.charAt(0);)b=b.substring(1,b.length);if(0===b.indexOf(a))return b.substring(a.length,b.length)}return null},a.prototype.remove=function(a){return this.set(a,"",-1)},a}(),Commerce.Cart=function(){function a(a){this.c=a,this.init()}return a.prototype.init=function(a){var b;return null==a&&(a=!1),b=this.c,a||null===this.c.Storage.get("commercejs_cart_id")?a?this.c.Request("carts/"+a,"GET",null,function(a){return b.Storage.set("commercejs_cart_id",a.id,30),b.Cart.cart_id=a.id,b.Event("Cart.Ready")},function(a){return b.Cart.refresh()}):this.refresh():this.c.Request("carts/"+this.c.Storage.get("commercejs_cart_id"),"GET",null,function(a){return b.Cart.cart_id=a.id,b.Event("Cart.Ready")},function(a){return b.Cart.refresh()})},a.prototype.refresh=function(){var a;return a=this.c,this.c.Request("carts","GET",null,function(b){return a.Storage.set("commercejs_cart_id",b.id,30),a.Cart.cart_id=b.id,a.Event("Cart.Ready")})},a.prototype.id=function(){return this.cart_id},a.prototype.add=function(a,b,c){return this.c.Request("carts/"+this.cart_id,"POST",a,b,c)},a.prototype.retrieve=function(a,b){return this.c.Request("carts/"+this.cart_id,"GET",null,a,b)},a.prototype.remove=function(a,b,c){return this.c.Request("carts/"+this.cart_id+"/items/"+a,"DELETE",null,b,c)},a.prototype.delete=function(a,b){return this.c.Request("carts/"+this.cart_id,"DELETE",null,a,b)},a.prototype.update=function(a,b,c,d){return this.c.Request("carts/"+this.cart_id+"/items/"+a,"PUT",b,c,d)},a.prototype.contents=function(a,b){return this.c.Request("carts/"+this.cart_id+"/items","GET",null,a,b)},a.prototype.empty=function(a,b){return this.c.Request("carts/"+this.cart_id+"/items","DELETE",null,a,b)},a}(),Commerce.Categories=function(){function a(a){this.c=a}return a.prototype.list=function(a,b,c){return"function"==typeof a?this.c.Request("categories","GET",null,a,b):this.c.Request("categories","GET",a,b,c)},a.prototype.retrieve=function(a,b,c,d){return this.c.Request("categories/"+a,"GET",b,c,d)},a}(),Commerce.Checkout=function(){function Checkout(a){this.c=a}return Checkout.prototype.protect=function(token){return this.c.Request("checkouts/"+token+"/protect","GET",null,function(data){return eval(data.sift_js)})},Checkout.prototype.generateToken=function(a,b,c,d){return this.c.Request("checkouts/"+a,"GET",b,c,d)},Checkout.prototype.capture=function(a,b,c,d){return this.c.Request("checkouts/"+a,"POST",b,c,d)},Checkout.prototype.checkPaypalStatus=function(a,b,c){return this.c.Request("checkouts/"+a+"/check/paypal/payment","GET",null,b,c)},Checkout.prototype.checkPaypalOrderCaptured=function(a,b,c){return this.c.Request("checkouts/"+a+"/check/paypal/captured","GET",null,b,c)},Checkout.prototype.receipt=function(a,b,c){return this.c.Request("checkouts/"+a+"/receipt","GET",null,b,c)},Checkout.prototype.checkPayWhatYouWant=function(a,b,c,d){return this.c.Request("checkouts/"+a+"/check/pay_what_you_want","GET",b,c,d)},Checkout.prototype.fields=function(a,b,c){return this.c.Request("checkouts/"+a+"/fields","GET",null,b,c)},Checkout.prototype.setTaxZone=function(a,b,c,d){return this.c.Request("checkouts/"+a+"/helper/set_tax_zone","GET",b,c,d)},Checkout.prototype.getLocationFromIP=function(a,b,c,d){return null===b&&(b=""),"function"==typeof b?this.c.Request("checkouts/"+a+"/helper/location_from_ip","GET",null,b,d):this.c.Request("checkouts/"+a+"/helper/location_from_ip","GET",{ip_address:b},c,d)},Checkout.prototype.isFree=function(a,b,c){return this.c.Request("checkouts/"+a+"/check/is_free","GET",null,b,c)},Checkout.prototype.checkVariant=function(a,b,c,d,e){return this.c.Request("checkouts/"+a+"/check/"+b+"/variant","GET",c,d,e)},Checkout.prototype.checkDiscount=function(a,b,c,d){return this.c.Request("checkouts/"+a+"/check/discount","GET",b,c,d)},Checkout.prototype.checkShippingOption=function(a,b,c,d){return this.c.Request("checkouts/"+a+"/check/shipping","GET",b,c,d)},Checkout.prototype.getShippingOptions=function(a,b,c,d){return this.c.Request("checkouts/"+a+"/helper/shipping_options","GET",b,c,d)},Checkout.prototype.checkQuantity=function(a,b,c,d,e){return this.c.Request("checkouts/"+a+"/check/"+b+"/quantity","GET",c,d,e)},Checkout.prototype.helperValidation=function(a,b,c){return this.c.Request("checkouts/"+a+"/helper/validation","GET",null,b,c)},Checkout.prototype.getLive=function(a,b,c){return this.c.Request("checkouts/"+a+"/live","GET",null,b,c)},Checkout.prototype.getToken=function(a,b,c){return this.c.Request("checkouts/tokens/"+a,"GET",null,b,c)},Checkout.prototype.checkGiftcard=function(a,b,c,d){return this.c.Request("checkouts/"+a+"/check/giftcard","GET",b,c,d)},Checkout}(),Commerce.Merchants=function(){function a(a){this.c=a}return a.prototype.about=function(a,b){return this.c.Request("merchants","GET",null,a,b)},a}(),Commerce.Products=function(){function a(a){this.c=a}return a.prototype.list=function(a,b,c){return"function"==typeof a?this.c.Request("products","GET",null,a,b):this.c.Request("products","GET",a,b,c)},a.prototype.retrieve=function(a,b,c,d){return this.c.Request("products/"+a,"GET",b,c,d)},a}(),Commerce.Services=function(){function a(a){this.c=a}return a.prototype.localeListCountries=function(a,b){return this.c.Request("services/locale/countries","GET",null,a,b)},a.prototype.localeListShippingCountries=function(a,b,c){return this.c.Request("services/locale/"+a+"/countries","GET",null,b,c)},a.prototype.localeListShippingSubdivisions=function(a,b,c,d){return this.c.Request("services/locale/"+a+"/countries/"+b+"/subdivisions","GET",null,c,d)},a.prototype.localeListSubdivisions=function(a,b,c){return this.c.Request("services/locale/"+a+"/subdivisions","GET",{},b,c)},a}(),module.exports=Commerce;